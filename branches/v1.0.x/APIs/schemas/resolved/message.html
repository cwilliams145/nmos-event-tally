---
layout: default
title: Schema message.json
---

<html>
<meta charset="UTF-8">
<h2>Schema message.json</h2>
<p>
    <a href="../../schemas/with-refs/message.html">Show original (referenced schemas with $ref)</a>
</p>
<div id="json-render">
<script type="text/javascript" src="codemirror/lib/codemirror.js"></script>
<link rel="stylesheet" href="codemirror/lib/codemirror.css">
<link rel="stylesheet" href="codemirror/addon/fold/foldgutter.css">
<script src="codemirror/mode/javascript/javascript.js"></script>
<script src="codemirror/addon/fold/foldcode.js"></script>
<script src="codemirror/addon/fold/foldgutter.js"></script>
<script src="codemirror/addon/fold/brace-fold.js"></script>
<script src="codemirror/addon/fold/indent-fold.js"></script>

<style>
  .CodeMirror {
    border-top: 1px solid black; 
    border-bottom: 1px solid black;
    height: 500px;
  }
</style>

<textarea id="mytextarea">
{
    "$id": "https://www.amwa.tv/event_and_tally/message.json",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "description": "Allowed messages (communication from the sender to the receiver)",
    "oneOf": [
        {
            "$id": "https://www.amwa.tv/event_and_tally/event.json",
            "$schema": "http://json-schema.org/draft-04/schema#",
            "description": "Message that gets sent out when the source state changes",
            "oneOf": [
                {
                    "$id": "https://www.amwa.tv/event_and_tally/event_boolean.json",
                    "$schema": "http://json-schema.org/draft-04/schema#",
                    "allOf": [
                        {
                            "$id": "https://www.amwa.tv/event_and_tally/event_core.json",
                            "$schema": "http://json-schema.org/draft-04/schema#",
                            "description": "Message that gets sent out when the source state changes",
                            "properties": {
                                "identity": {
                                    "description": "Object describing event identity",
                                    "properties": {
                                        "flow_id": {
                                            "description": "ID of the flow carrying the message",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        },
                                        "source_id": {
                                            "description": "ID of the source that holds the state that has changed",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "source_id"
                                    ],
                                    "type": "object"
                                },
                                "message_type": {
                                    "description": "A fixed string showing this is a state message",
                                    "pattern": "^state$",
                                    "type": "string"
                                },
                                "timing": {
                                    "description": "Object describing event timing",
                                    "properties": {
                                        "action_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the state change described in the event took or will take place",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "creation_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "origin_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message that triggered this message (if any) was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "creation_timestamp"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "identity",
                                "timing",
                                "event_type",
                                "payload",
                                "message_type"
                            ],
                            "title": "State change event",
                            "type": "object"
                        },
                        {
                            "properties": {
                                "event_type": {
                                    "description": "Event type",
                                    "pattern": "^boolean(\\/[^\\s\\/]+)*$",
                                    "type": "string"
                                },
                                "payload": {
                                    "description": "Boolean payload",
                                    "properties": {
                                        "value": {
                                            "description": "Boolean value",
                                            "type": "boolean"
                                        }
                                    },
                                    "required": [
                                        "value"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "event_type",
                                "payload"
                            ],
                            "type": "object"
                        }
                    ],
                    "description": "Describes an event with boolean payload",
                    "title": "Boolean event",
                    "type": "object"
                },
                {
                    "$id": "https://www.amwa.tv/event_and_tally/event_number.json",
                    "$schema": "http://json-schema.org/draft-04/schema#",
                    "allOf": [
                        {
                            "$id": "https://www.amwa.tv/event_and_tally/event_core.json",
                            "$schema": "http://json-schema.org/draft-04/schema#",
                            "description": "Message that gets sent out when the source state changes",
                            "properties": {
                                "identity": {
                                    "description": "Object describing event identity",
                                    "properties": {
                                        "flow_id": {
                                            "description": "ID of the flow carrying the message",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        },
                                        "source_id": {
                                            "description": "ID of the source that holds the state that has changed",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "source_id"
                                    ],
                                    "type": "object"
                                },
                                "message_type": {
                                    "description": "A fixed string showing this is a state message",
                                    "pattern": "^state$",
                                    "type": "string"
                                },
                                "timing": {
                                    "description": "Object describing event timing",
                                    "properties": {
                                        "action_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the state change described in the event took or will take place",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "creation_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "origin_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message that triggered this message (if any) was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "creation_timestamp"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "identity",
                                "timing",
                                "event_type",
                                "payload",
                                "message_type"
                            ],
                            "title": "State change event",
                            "type": "object"
                        },
                        {
                            "properties": {
                                "event_type": {
                                    "description": "Event type",
                                    "pattern": "^number(\\/[^\\s\\/]+)*$",
                                    "type": "string"
                                },
                                "payload": {
                                    "$id": "https://www.amwa.tv/event_and_tally/number.json",
                                    "$schema": "http://json-schema.org/draft-04/schema#",
                                    "description": "Number",
                                    "properties": {
                                        "scale": {
                                            "description": "Denominator for rational number representation (default = 1)",
                                            "minimum": 1,
                                            "type": "integer"
                                        },
                                        "value": {
                                            "description": "Number value",
                                            "type": "number"
                                        }
                                    },
                                    "required": [
                                        "value"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "event_type",
                                "payload"
                            ],
                            "type": "object"
                        }
                    ],
                    "description": "Describes an event with Number payload",
                    "title": "Number event",
                    "type": "object"
                },
                {
                    "$id": "https://www.amwa.tv/event_and_tally/event_string.json",
                    "$schema": "http://json-schema.org/draft-04/schema#",
                    "allOf": [
                        {
                            "$id": "https://www.amwa.tv/event_and_tally/event_core.json",
                            "$schema": "http://json-schema.org/draft-04/schema#",
                            "description": "Message that gets sent out when the source state changes",
                            "properties": {
                                "identity": {
                                    "description": "Object describing event identity",
                                    "properties": {
                                        "flow_id": {
                                            "description": "ID of the flow carrying the message",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        },
                                        "source_id": {
                                            "description": "ID of the source that holds the state that has changed",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "source_id"
                                    ],
                                    "type": "object"
                                },
                                "message_type": {
                                    "description": "A fixed string showing this is a state message",
                                    "pattern": "^state$",
                                    "type": "string"
                                },
                                "timing": {
                                    "description": "Object describing event timing",
                                    "properties": {
                                        "action_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the state change described in the event took or will take place",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "creation_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "origin_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message that triggered this message (if any) was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "creation_timestamp"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "identity",
                                "timing",
                                "event_type",
                                "payload",
                                "message_type"
                            ],
                            "title": "State change event",
                            "type": "object"
                        },
                        {
                            "properties": {
                                "event_type": {
                                    "description": "Event type",
                                    "pattern": "^string(\\/[^\\s\\/]+)*$",
                                    "type": "string"
                                },
                                "payload": {
                                    "description": "String payload",
                                    "properties": {
                                        "value": {
                                            "description": "String value",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "value"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "event_type",
                                "payload"
                            ],
                            "type": "object"
                        }
                    ],
                    "description": "Describes an event with string payload",
                    "title": "String event",
                    "type": "object"
                },
                {
                    "$id": "https://www.amwa.tv/event_and_tally/event_object.json",
                    "$schema": "http://json-schema.org/draft-04/schema#",
                    "allOf": [
                        {
                            "$id": "https://www.amwa.tv/event_and_tally/event_core.json",
                            "$schema": "http://json-schema.org/draft-04/schema#",
                            "description": "Message that gets sent out when the source state changes",
                            "properties": {
                                "identity": {
                                    "description": "Object describing event identity",
                                    "properties": {
                                        "flow_id": {
                                            "description": "ID of the flow carrying the message",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        },
                                        "source_id": {
                                            "description": "ID of the source that holds the state that has changed",
                                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "source_id"
                                    ],
                                    "type": "object"
                                },
                                "message_type": {
                                    "description": "A fixed string showing this is a state message",
                                    "pattern": "^state$",
                                    "type": "string"
                                },
                                "timing": {
                                    "description": "Object describing event timing",
                                    "properties": {
                                        "action_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the state change described in the event took or will take place",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "creation_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        },
                                        "origin_timestamp": {
                                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message that triggered this message (if any) was created",
                                            "pattern": "^[0-9]+:[0-9]+$",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "creation_timestamp"
                                    ],
                                    "type": "object"
                                }
                            },
                            "required": [
                                "identity",
                                "timing",
                                "event_type",
                                "payload",
                                "message_type"
                            ],
                            "title": "State change event",
                            "type": "object"
                        },
                        {
                            "properties": {
                                "event_type": {
                                    "description": "Event type",
                                    "pattern": "^object(\\/[^\\s\\/]+)*$",
                                    "type": "string"
                                },
                                "payload": {
                                    "description": "Object payload",
                                    "type": "object"
                                }
                            },
                            "required": [
                                "event_type",
                                "payload"
                            ],
                            "type": "object"
                        }
                    ],
                    "description": "Describes an event with object payload",
                    "title": "Object event",
                    "type": "object"
                }
            ],
            "title": "State change event",
            "type": "object"
        },
        {
            "$id": "https://www.amwa.tv/event_and_tally/message_connection_status.json",
            "$schema": "http://json-schema.org/draft-04/schema#",
            "description": "Message that indicates the status of the connection between the MQTT client and the broker. If connection status messages are used, the publishing topic is connection specific and must be specified in the connection_status_broker_topic parameter of the MQTT IS-05 transport parameters object. The client must publish this message with the RETAIN flag set, after opening the connection to the broker and before closing the connection normally. The client must also configure a retained Will Message indicating it is disconnected.",
            "properties": {
                "active": {
                    "description": "A boolean value showing whether the MQTT client is connected to the broker.",
                    "type": "boolean"
                },
                "message_type": {
                    "description": "A fixed string showing this is a connection status message",
                    "pattern": "^connection_status$",
                    "type": "string"
                }
            },
            "required": [
                "message_type",
                "active"
            ],
            "title": "Connection status message",
            "type": "object"
        },
        {
            "$id": "https://www.amwa.tv/event_and_tally/message_health.json",
            "$schema": "http://json-schema.org/draft-04/schema#",
            "description": "Message that gets sent out as the response to a health (heartbeat) command",
            "properties": {
                "message_type": {
                    "description": "A fixed string showing this is a health message",
                    "pattern": "^health$",
                    "type": "string"
                },
                "timing": {
                    "description": "Object describing event timing",
                    "properties": {
                        "creation_timestamp": {
                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                            "pattern": "^[0-9]+:[0-9]+$",
                            "type": "string"
                        },
                        "origin_timestamp": {
                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) copied from the incoming health command",
                            "pattern": "^[0-9]+:[0-9]+$",
                            "type": "string"
                        }
                    },
                    "required": [
                        "creation_timestamp",
                        "origin_timestamp"
                    ],
                    "type": "object"
                }
            },
            "required": [
                "timing",
                "message_type"
            ],
            "title": "Health message",
            "type": "object"
        },
        {
            "$id": "https://www.amwa.tv/event_and_tally/message_shutdown_reboot.json",
            "$schema": "http://json-schema.org/draft-04/schema#",
            "description": "Message that gets sent out when the device start a shutdown or reboot process",
            "properties": {
                "identity": {
                    "description": "Object describing event identity",
                    "properties": {
                        "flow_id": {
                            "description": "ID of the flow carrying the message",
                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                            "type": "string"
                        },
                        "source_id": {
                            "description": "ID of the source which identifies the emitter of the event",
                            "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$",
                            "type": "string"
                        }
                    },
                    "required": [
                        "source_id"
                    ],
                    "type": "object"
                },
                "message_type": {
                    "description": "A fixed string showing this is a reboot or a shutdown message",
                    "pattern": "^reboot|shutdown$",
                    "type": "string"
                },
                "timing": {
                    "description": "Object describing event timing",
                    "properties": {
                        "creation_timestamp": {
                            "description": "String formatted TAI timestamp (<seconds>:<nanoseconds>) indicating when the message was created",
                            "pattern": "^[0-9]+:[0-9]+$",
                            "type": "string"
                        }
                    },
                    "required": [
                        "creation_timestamp"
                    ],
                    "type": "object"
                }
            },
            "required": [
                "identity",
                "timing",
                "message_type"
            ],
            "title": "Shutdown and reboot message",
            "type": "object"
        }
    ],
    "title": "Message",
    "type": "object"
}
</textarea>
<script>
window.editor_json = CodeMirror.fromTextArea(mytextarea, {
    mode: {
        name: "javascript",
        json: true
    },
    readOnly: true,
    lineNumbers: false,
    lineWrapping: true,
    extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
    foldGutter: true,
    gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
    foldOptions: {
      widget: (from, to) => {
        var count = undefined;

        // Get open / close token
        var startToken = '{', endToken = '}';
        var prevLine = window.editor_json.getLine(from.line);
        if (prevLine.lastIndexOf('[') > prevLine.lastIndexOf('{')) {
          startToken = '[', endToken = ']';
        }

        // Get json content
        var internal = window.editor_json.getRange(from, to);
        var toParse = startToken + internal + endToken;

        // Get key count
        try {
          var parsed = JSON.parse(toParse);
          count = Object.keys(parsed).length;
        } catch(e) { }

        return count ? `\u21A4${count}\u21A6` : '\u2194';
        }
      }
    }
  );
editor_json.
editor_json.foldCode(CodeMirror.Pos(3, 0));
</script>
</div>
</html>
